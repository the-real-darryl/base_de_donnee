SET SERVEROUTPUT ON

DECLARE
	NB NUMBER(1):=0;
BEGIN
	SELECT COUNT(TABLE_NAME) INTO NB FROM TABS WHERE UPPER(TABLE_NAME)= 'DD_PRODUIT';
	IF NB > 0 THEN
		DBMS_OUTPUT.PUT_LINE('La table DD_PRODUIT existe deja!');
	ELSE
		EXECUTE IMMEDIATE 'CREATE TABLE DD_PRODUIT(
					NUMPROD VARCHAR2(10) PRIMARY KEY,
					NOM VARCHAR2(50),
					NUMCAT VARCHAR2(50))';
	END IF;

	SELECT COUNT(TABLE_NAME) INTO NB FROM TABS WHERE UPPER(TABLE_NAME)= 'DD_CLIENT';
	IF NB > 0 THEN
		DBMS_OUTPUT.PUT_LINE('La table DD_CLIENT existe deja!');
	ELSE
		EXECUTE IMMEDIATE 'CREATE TABLE DD_CLIENT (
					NUMCLIENT CHAR(7) PRIMARY KEY,
					PRENOM VARCHAR2(50),
					NOMCLIENT VARCHAR2(50),
					NORUE NUMBER(5),
					NOMRUE VARCHAR2(50),
					VILLE VARCHAR2(50),
					PROVINCE VARCHAR2(50),
					CODEPOSTALE VARCHAR2(10),
					PAYS VARCHAR2(50),
					TELEPHONE VARCHAR2(10))';
	END IF;

	SELECT COUNT(TABLE_NAME) INTO NB FROM TABS WHERE UPPER(TABLE_NAME)= 'DD_VENTECLIENT';
	IF NB > 0 THEN
		DBMS_OUTPUT.PUT_LINE('La table DD_VENTECLIENT existe deja!');
	ELSE
		EXECUTE IMMEDIATE 'CREATE TABLE DD_VENTECLIENT (
					CODEVENTE VARCHAR2(10) PRIMARY KEY,
					NUMCLIENT CHAR(7) NOT NULL,
					NUMPROD VARCHAR2(7) NOT NULL,
					DATEVENTE date,
					QUANTITEVENDUE NUMBER(8),
					PRIXVENTE NUMBER(10,2),
					CONSTRAINT FK_NUMCLIENT FOREIGN KEY (NUMCLIENT)
					REFERENCES DD_CLIENT(NUMCLIENT),
					CONSTRAINT FK_NUMPROD FOREIGN KEY (NUMPROD)
					REFERENCES DD_PRODUIT(NUMPROD) ON DELETE CASCADE)';
	END IF;
END;
/

--PROMPT Appuyer sut une touche ...
--PAUSE
--@c:\bd\examen22032018\menu.sql
